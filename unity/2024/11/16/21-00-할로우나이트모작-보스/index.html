<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset="utf-8">
  <title>애니메이터를 활용한 보스 AI 구현</title>
  <meta name="description"
    content="BlogBox is a bold theme for the Jekyll blogging platform. Available for purchase at ThemeForest.net.
">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" type="text/css"
    href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700,700italic%7COpen+Sans:400,700,400italic,700italic" />
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="canonical" href="https://bsj2234.github.io/unity/2024/11/16/21-00-%ED%95%A0%EB%A1%9C%EC%9A%B0%EB%82%98%EC%9D%B4%ED%8A%B8%EB%AA%A8%EC%9E%91-%EB%B3%B4%EC%8A%A4/">
  <link rel="alternate" type="application/rss+xml" title="BlogBox Feed"
    href="https://bsj2234.github.io/feed.xml">
  <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
</head>

<body class="">
  <div id="page" class="site">
    <nav class="site-nav" aria-label="Main Menu">
    <div class="inner">
        <button id="menu-toggle" class="menu-toggle" aria-expanded="false"><span class="icon-menu" aria-hidden="true"></span> Menu</button>
        <div id="nav-menu" class="nav-menu">
            <ul class="menu">
            
                
                
                <li class=""><a class="" href="/">홈</a></li>
            
                
                
                <li class=""><a class="" href="/blog/">블로그</a></li>
            
                
                
                <li class=""><a class="" href="/about/">소개</a></li>
            
            </ul>
        </div><!-- .nav-menu -->
        <a id="search-open" class="search-toggle"><i class="fa-search" aria-hidden="true"></i><span class="screen-reader-text">Search</span></a>
    </div><!-- .inner -->
</nav><!-- .site-nav -->
<header class="site-header fade-in-down delay-0_5s">
    <div class="inner">
        
        <h1 class="site-title"><a href="/" rel="home">BlogBox</a></h1>
        
        <p class="site-description">Tales of a digital nomad.</p>
    </div><!-- .inner -->
</header><!-- .site-header -->

<!-- Add Mermaid support -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.3/mermaid.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default'
    });
  });
</script>

<section class="site-search" role="search">
		<div class="search-scrollable">
			<div class="search-box">
				<div class="search-box-inside">
					<h2 class="screen-reader-text">Search </h2>
					<form class="search-form">
						<label class="screen-reader-text">Search for:</label>
						<input type="text" id="search-field" class="search-field" placeholder="Type your keywords&hellip;" />
						<input type="submit" class="search-submit screen-reader-text" value="Search" />
					</form>
					<ul id="search-results" class="search-results"></ul>
				</div><!-- .search-box-inside -->
				<button id="search-close" class="search-toggle"><span class="close-icon" aria-hidden="true"></span><span class="screen-reader-text">Close</span></button>
			</div><!-- .search-box -->
		</div><!-- .search-scrollable -->
</section><!-- .site-search -->


    <main class="content fade-in-down delay-0_75s">
    <div class="inner-wide blog-layout">
        <aside class="category-sidebar">
    <h2 class="sidebar-title">Categories</h2>
    <ul class="category-list">
        <li class="category-item active">
            <a href="/blog/">
                All Posts
                <span class="count">(32)</span>
            </a>
        </li>
        
        
            
            
            <li class="category-item ">
                <a href="/blog/category/blog">
                    Blog
                    <span class="count">(2)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/blog/jekyll">
                    Blog/Jekyll
                    <span class="count">(1)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/csharp">
                    CSharp
                    <span class="count">(2)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/codingtest">
                    CodingTest
                    <span class="count">(11)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/computerscience">
                    ComputerScience
                    <span class="count">(3)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/datastructure">
                    DataStructure
                    <span class="count">(1)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/graphics">
                    Graphics
                    <span class="count">(1)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/network">
                    Network
                    <span class="count">(1)</span>
                </a>
            </li>
        
            
            
            <li class="category-item ">
                <a href="/blog/category/unity">
                    Unity
                    <span class="count">(9)</span>
                </a>
            </li>
        
    </ul>
</aside> 
        <div class="blog-content">
            <article class="post">
                
                <div class="entry-box">
                    <header class="entry-header">
                        <h1 class="entry-title">애니메이터를 활용한 보스 AI 구현</h1>
                        <div class="entry-meta">
                            <time class="post-date" datetime="2024-11-16">November 16, 2024</time> by 변석진
                        </div>
                    </header>
                    <div class="entry-content">
                        <h1 id="애니메이터를-활용한-보스-ai-구현-분석">애니메이터를 활용한 보스 AI 구현 분석</h1>

<h2 id="개요">개요</h2>
<p>Unity의 Animator를 스테이트 머신으로 활용하여 보스 AI를 구현했습니다</p>

<h2 id="구현-구조">구현 구조</h2>
<p><img src="image-1.png" alt="alt text" /></p>
<h3 id="1-애니메이터-설계">1. 애니메이터 설계</h3>
<ul>
  <li>Idle, Attack, Groggy 상태 구현</li>
  <li>각 상태 간 전환 조건 설정</li>
  <li>파라미터를 통한 상태 제어</li>
  <li>스테이트 비헤이비어 코드를 사용한 스테이트 진입시 스크립트 실행</li>
</ul>

<h3 id="2-코드-구현">2. 코드 구현</h3>

<h4 id="기본-보스-클래스">기본 보스 클래스</h4>
<div class="code-block-container">
    <button class="code-toggle">Expand</button>
    
<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">TMPro</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Assertions</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">FalseKnightMainBody</span> <span class="p">:</span> <span class="n">Character</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">FalseKnight</span> <span class="n">owner</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">CombatComponent</span> <span class="n">combatComponent</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">Action</span> <span class="n">OnFalseKnightDead</span><span class="p">;</span>

    <span class="k">private</span> <span class="n">Animator</span> <span class="n">_animator</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">damagedEffects</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_animator</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Animator</span><span class="p">&gt;();</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">_animator</span><span class="p">);</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">combatComponent</span><span class="p">);</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="n">transform</span><span class="p">);</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="n">OnDamaged</span> <span class="p">+=</span> <span class="n">OnDamaged</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="n">OnDead</span> <span class="p">+=</span> <span class="n">OnDead</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ResetMainBody</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="nf">ResetDead</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Spawn</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">ResetMainBody</span><span class="p">();</span>
        <span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnDamaged</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Hit"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnDead</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">OnFalseKnightDead</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">();</span>
        <span class="n">gameObject</span><span class="p">.</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="n">CombatComponent</span> <span class="nf">GetCombatComponent</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">combatComponent</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

    </code></pre></figure>

</div>

<div class="code-block-container">
    <button class="code-toggle">Expand</button>
    
<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp">    
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Unity.VisualScripting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Assertions</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Rendering.Universal</span><span class="p">;</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">FalseKnightState</span>
<span class="p">{</span>
    <span class="n">Idle</span><span class="p">,</span> <span class="n">JumpAttack</span><span class="p">,</span> <span class="n">Jump</span><span class="p">,</span> <span class="n">GroundAttack</span><span class="p">,</span> <span class="n">Rampage</span><span class="p">,</span> <span class="n">MainBody</span><span class="p">,</span> <span class="n">Dead</span>
<span class="p">}</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">FalseKnight</span> <span class="p">:</span> <span class="n">Character</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">FalseKnightState</span> <span class="n">state</span><span class="p">;</span>

    <span class="c1">//public MoveComponent moveComponent;</span>
    <span class="k">public</span> <span class="n">CombatComponent</span> <span class="n">combatComponent</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="n">isGrounded</span><span class="p">;</span>

    <span class="k">private</span> <span class="n">Animator</span> <span class="n">_animator</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Transform</span> <span class="n">_target</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Rigidbody2D</span> <span class="n">_rigidbody</span><span class="p">;</span>

    <span class="c1">//점프할때 grounded 잠시 무시해줘야 isgrounded가 예상대로 작동함 안그러면 점프 하자마자 착지했다고 판정됨</span>
    <span class="c1">//아니면 점프에서 isjumping set 하고 점핑과 alomostOnGroun와 Is Jumping이 둘다 false일때 착지 모션을 들어가게 하자</span>
    <span class="k">private</span> <span class="kt">float</span> <span class="n">groundIgnoreTime</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">float</span> <span class="n">_invincibleTime</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">int</span> <span class="n">Phase</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="n">Light2D</span> <span class="n">_light</span><span class="p">;</span>

    <span class="c1">//죽었을때 나오는 소울</span>
    <span class="p">[</span><span class="n">SerializeField</span><span class="p">]</span> <span class="k">private</span> <span class="n">FalseKnightMainBody</span> <span class="n">_mainBody</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">damagedEffects</span><span class="p">;</span>

    <span class="k">public</span> <span class="n">System</span><span class="p">.</span><span class="n">Action</span><span class="p">&lt;</span><span class="n">FalseKnight</span><span class="p">&gt;</span> <span class="n">OnStatusChange</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">System</span><span class="p">.</span><span class="n">Action</span> <span class="n">OnFlip</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">System</span><span class="p">.</span><span class="n">Action</span> <span class="n">OnRealDead</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">bool</span> <span class="n">Fighting</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">Transform</span><span class="p">[]</span> <span class="n">_jumpTargets</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Awake</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_animator</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">GetComponentInChildren</span><span class="p">&lt;</span><span class="n">Animator</span><span class="p">&gt;();</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">_animator</span><span class="p">);</span>
        <span class="n">_rigidbody</span> <span class="p">=</span> <span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">Rigidbody2D</span><span class="p">&gt;();</span>
        <span class="n">_target</span> <span class="p">=</span> <span class="n">GameManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">GetPlayer</span><span class="p">().</span><span class="n">transform</span><span class="p">;</span>
        <span class="n">_mainBody</span> <span class="p">=</span> <span class="n">_mainBody</span><span class="p">.</span><span class="n">GetComponent</span><span class="p">&lt;</span><span class="n">FalseKnightMainBody</span><span class="p">&gt;();</span>
        <span class="n">_mainBody</span><span class="p">.</span><span class="n">OnFalseKnightDead</span> <span class="p">+=</span> <span class="n">OnMainbodyCurrentDead</span><span class="p">;</span>
        <span class="n">OnRealDead</span> <span class="p">+=</span> <span class="n">RealDead</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="n">OnDead</span> <span class="p">+=</span> <span class="n">OnCurrentDead</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="n">OnDamaged</span> <span class="p">+=</span> <span class="n">OnDamaged</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="n">AdditionalDamageableCondition</span> <span class="p">+=</span> <span class="n">IsDamagable</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="nf">Init</span><span class="p">(</span><span class="n">transform</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="kt">bool</span> <span class="nf">IsDamagable</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">state</span> <span class="p">==</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">MainBody</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">ChangeState</span><span class="p">(</span><span class="n">FalseKnightState</span> <span class="n">newState</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">state</span> <span class="p">=</span> <span class="n">newState</span><span class="p">;</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">newState</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Idle</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Idle"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">JumpAttack</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"JumpAttack"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Jump</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Jump"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">GroundAttack</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"GroundAttack"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Rampage</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Rampage"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">MainBody</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Stun"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Dead</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Dead"</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="p">:</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnEnable</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">isGrounded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Spawn"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//무적 시간과 grounded 애니메이터 플래그 셋</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">state</span> <span class="p">==</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Dead</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">groundIgnoreTime</span> <span class="p">&gt;</span> <span class="m">0f</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">groundIgnoreTime</span> <span class="p">-=</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span>
            <span class="n">_animator</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"AlmostOnGround"</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">isGrounded</span><span class="p">)</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"AlmostOnGround"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
            <span class="k">else</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"AlmostOnGround"</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_invincibleTime</span> <span class="p">&gt;</span> <span class="m">0f</span><span class="p">)</span> <span class="p">{</span> <span class="n">_invincibleTime</span> <span class="p">-=</span> <span class="n">Time</span><span class="p">.</span><span class="n">deltaTime</span><span class="p">;</span> <span class="p">}</span>

    <span class="p">}</span>


    <span class="c1">//Ai funcs</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">JumpToTarget</span><span class="p">(</span><span class="kt">float</span> <span class="n">time</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_rigidbody</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
        <span class="n">isGrounded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">groundIgnoreTime</span> <span class="p">=</span> <span class="p">.</span><span class="m">2f</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">distance</span> <span class="p">=</span> <span class="n">_target</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="n">_rigidbody</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">distance</span> <span class="p">/</span> <span class="n">time</span><span class="p">,</span> <span class="m">9.81f</span> <span class="p">*</span> <span class="n">time</span> <span class="p">*</span> <span class="p">.</span><span class="m">5f</span><span class="p">),</span> <span class="n">ForceMode2D</span><span class="p">.</span><span class="n">Impulse</span><span class="p">);</span>
        <span class="nf">FocusToPlayer</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">FocusToPlayer</span><span class="p">()</span>
    <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">_target</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">&lt;</span> <span class="m">0f</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">180f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">OnFlip</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OnFlip</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">JumpToFarPoint</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"AlmostOnGround"</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
        <span class="n">groundIgnoreTime</span> <span class="p">+=</span> <span class="p">.</span><span class="m">1f</span><span class="p">;</span>
        <span class="n">Vector3</span> <span class="n">targetPos</span> <span class="p">=</span> <span class="nf">GetFarJumpTarget</span><span class="p">();</span>
        <span class="kt">float</span> <span class="n">targetVector</span> <span class="p">=</span> <span class="p">-</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">+</span> <span class="n">targetPos</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">time</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">targetVector</span> <span class="p">*</span> <span class="p">.</span><span class="m">1f</span><span class="p">);</span>
        <span class="n">_rigidbody</span><span class="p">.</span><span class="nf">AddForce</span><span class="p">(</span><span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">targetVector</span> <span class="p">/</span> <span class="n">time</span><span class="p">,</span> <span class="m">9.81f</span> <span class="p">*</span> <span class="n">time</span> <span class="p">*</span> <span class="p">.</span><span class="m">5f</span><span class="p">),</span> <span class="n">ForceMode2D</span><span class="p">.</span><span class="n">Impulse</span><span class="p">);</span>
        <span class="nf">FocusToPlayer</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="n">Vector3</span> <span class="nf">GetFarJumpTarget</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Transform</span> <span class="n">target</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">maxDist</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="n">Transform</span> <span class="n">t</span> <span class="k">in</span> <span class="n">_jumpTargets</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">float</span> <span class="n">dist</span> <span class="p">=</span> <span class="n">Mathf</span><span class="p">.</span><span class="nf">Abs</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="p">-</span> <span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dist</span> <span class="p">&gt;</span> <span class="n">maxDist</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">maxDist</span> <span class="p">=</span> <span class="n">dist</span><span class="p">;</span>
                <span class="n">target</span> <span class="p">=</span> <span class="n">t</span><span class="p">;</span>
            <span class="p">}</span>            
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">target</span><span class="p">.</span><span class="n">position</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnCurrentDead</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">switch</span> <span class="p">(</span><span class="n">Phase</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="m">1</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Groggy"</span><span class="p">);</span>
                <span class="n">state</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">MainBody</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="m">2</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Groggy"</span><span class="p">);</span>
                <span class="n">state</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">MainBody</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="m">3</span><span class="p">:</span>
                <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Groggy"</span><span class="p">);</span>
                <span class="n">state</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">MainBody</span><span class="p">;</span>
                <span class="n">_mainBody</span><span class="p">.</span><span class="n">OnFalseKnightDead</span> <span class="p">-=</span> <span class="n">OnMainbodyCurrentDead</span><span class="p">;</span>
                <span class="n">_mainBody</span><span class="p">.</span><span class="n">OnFalseKnightDead</span> <span class="p">+=</span> <span class="n">OnRealDead</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">SpawnMainBody</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_mainBody</span><span class="p">.</span><span class="nf">Spawn</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnMainbodyCurrentDead</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Phase</span><span class="p">++;</span>
        <span class="n">_invincibleTime</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
        <span class="n">combatComponent</span><span class="p">.</span><span class="nf">ResetDead</span><span class="p">();</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"GroggyDead"</span><span class="p">);</span>
        <span class="n">state</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Idle</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">//죽으면 트리거 발생시키자 anystat로 빠진 후</span>
    <span class="c1">//날라가는 애니메이션 실행 메인바디 스폰 시키고</span>
    <span class="c1">//메인바디루프 돌다가 죽으면 다시 idle로 </span>

    <span class="c1">//Collisions GroundCheck</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">EvaluateCollision</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">collision</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">collision</span><span class="p">.</span><span class="n">contactCount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Vector2</span> <span class="n">normal</span> <span class="p">=</span> <span class="n">collision</span><span class="p">.</span><span class="nf">GetContact</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">normal</span><span class="p">;</span>
            <span class="n">isGrounded</span> <span class="p">|=</span> <span class="n">normal</span><span class="p">.</span><span class="n">y</span> <span class="p">&gt;=</span> <span class="p">.</span><span class="m">9f</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">collision</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">EvaluateCollision</span><span class="p">(</span><span class="n">collision</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">groundIgnoreTime</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="n">isGrounded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">isGrounded</span><span class="p">)</span>
            <span class="n">_rigidbody</span><span class="p">.</span><span class="n">velocity</span> <span class="p">=</span> <span class="n">Vector3</span><span class="p">.</span><span class="n">zero</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnCollisionStay2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">collision</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nf">EvaluateCollision</span><span class="p">(</span><span class="n">collision</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">groundIgnoreTime</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="n">isGrounded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnCollisionExit2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">collision</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">isGrounded</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">private</span> <span class="k">void</span> <span class="nf">DamagedEffect</span><span class="p">(</span><span class="n">Vector2</span> <span class="n">attackerPos</span><span class="p">,</span> <span class="n">Vector2</span> <span class="n">damagedPos</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_light</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">PooledObjectSpawnManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">SpawnBetweenAttacker</span><span class="p">(</span><span class="n">damagedEffects</span> <span class="p">,</span><span class="n">attackerPos</span><span class="p">,</span> <span class="n">damagedPos</span><span class="p">,</span> <span class="m">1.5f</span> <span class="p">,</span> <span class="m">4f</span><span class="p">);</span>
        <span class="nf">StartCoroutine</span><span class="p">(</span><span class="nf">BlinkOff</span><span class="p">());</span>

    <span class="p">}</span>

    <span class="k">private</span> <span class="n">IEnumerator</span> <span class="nf">BlinkOff</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">yield</span> <span class="k">return</span> <span class="k">new</span> <span class="nf">WaitForSeconds</span><span class="p">(.</span><span class="m">2f</span><span class="p">);</span>
        <span class="n">_light</span><span class="p">.</span><span class="n">enabled</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="kt">string</span> <span class="nf">GetPhase</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Phase</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Flip</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Quaternion</span> <span class="n">right</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">180f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
        <span class="n">Quaternion</span> <span class="n">left</span> <span class="p">=</span> <span class="n">Quaternion</span><span class="p">.</span><span class="nf">Euler</span><span class="p">(</span><span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">,</span> <span class="m">0f</span><span class="p">);</span>
        <span class="kt">float</span> <span class="n">curAngle</span> <span class="p">=</span> <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span><span class="p">.</span><span class="n">eulerAngles</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">curAngle</span> <span class="p">==</span> <span class="m">180f</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">left</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">transform</span><span class="p">.</span><span class="n">rotation</span> <span class="p">=</span> <span class="n">right</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">OnFlip</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OnFlip</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">OnGroggy</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_invincibleTime</span> <span class="p">=</span> <span class="m">99999999999999f</span><span class="p">;</span>
        <span class="nf">SpawnMainBody</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">override</span> <span class="n">CombatComponent</span> <span class="nf">GetCombatComponent</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">combatComponent</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnDamaged</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//UI</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">OnStatusChange</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OnStatusChange</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">RealDead</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Dead"</span><span class="p">);</span>
        <span class="n">state</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Dead</span><span class="p">;</span>
        <span class="n">PooledObjectSpawnManager</span><span class="p">.</span><span class="n">Instance</span><span class="p">.</span><span class="nf">SpawnMoney</span><span class="p">(</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="m">100</span><span class="p">);</span>
        <span class="nf">Destroy</span><span class="p">(</span><span class="n">gameObject</span><span class="p">,</span> <span class="m">30f</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">StartFight</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">_rigidbody</span><span class="p">.</span><span class="n">simulated</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">_animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Start"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">OnTriggerEnter2D</span><span class="p">(</span><span class="n">Collider2D</span> <span class="n">collision</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Fighting</span> <span class="p">==</span> <span class="k">true</span><span class="p">)</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">collision</span><span class="p">.</span><span class="nf">CompareTag</span><span class="p">(</span><span class="s">"Player"</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">Fighting</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">_animator</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="s">"Fighting"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
            <span class="n">_rigidbody</span><span class="p">.</span><span class="n">gravityScale</span> <span class="p">=</span> <span class="m">1f</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">SetJumpTarget</span><span class="p">(</span><span class="n">Transform</span><span class="p">[]</span> <span class="n">jumpTargets</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_jumpTargets</span> <span class="p">=</span> <span class="n">jumpTargets</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
    </code></pre></figure>

</div>

<h4 id="상태별-행동-구현">상태별 행동 구현</h4>
<div class="code-block-container">
    <button class="code-toggle">Expand</button>
    
<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="c1">//상태 결정 스크립트</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">FalseKnightSelectPattern</span> <span class="p">:</span> <span class="n">StateMachineBehaviour</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">float</span> <span class="n">CoolDown</span> <span class="p">=</span> <span class="p">.</span><span class="m">5f</span><span class="p">;</span>
    <span class="n">Timer</span> <span class="n">_timer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Timer</span><span class="p">();</span>
    <span class="k">public</span> <span class="n">FalseKnightState</span> <span class="n">debugAction</span> <span class="p">=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Idle</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnStateEnter</span><span class="p">(</span><span class="n">Animator</span> <span class="n">animator</span><span class="p">,</span> <span class="n">AnimatorStateInfo</span> <span class="n">stateInfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">layerIndex</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_timer</span><span class="p">.</span><span class="nf">SetTimer</span><span class="p">(</span><span class="n">CoolDown</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnStateUpdate</span><span class="p">(</span><span class="n">Animator</span> <span class="n">animator</span><span class="p">,</span> <span class="n">AnimatorStateInfo</span> <span class="n">stateInfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">layerIndex</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">_timer</span><span class="p">.</span><span class="nf">IsTimeOver</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="n">_timer</span><span class="p">.</span><span class="nf">ResetTime</span><span class="p">();</span>
            <span class="n">FalseKnightState</span> <span class="n">start</span> <span class="p">=</span> <span class="p">(</span><span class="n">FalseKnightState</span><span class="p">)</span><span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">6</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">debugAction</span> <span class="p">!=</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Idle</span><span class="p">)</span>
                <span class="n">start</span> <span class="p">=</span> <span class="n">debugAction</span><span class="p">;</span>
            <span class="k">switch</span> <span class="p">(</span><span class="n">start</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Idle</span><span class="p">:</span>
                    <span class="n">animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Idle"</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">JumpAttack</span><span class="p">:</span>
                    <span class="n">animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"JumpAttack"</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Jump</span><span class="p">:</span>
                    <span class="n">animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Jump"</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">GroundAttack</span><span class="p">:</span>
                    <span class="n">animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"GroundAttack"</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">case</span> <span class="n">FalseKnightState</span><span class="p">.</span><span class="n">Rampage</span><span class="p">:</span>
                    <span class="n">animator</span><span class="p">.</span><span class="nf">SetTrigger</span><span class="p">(</span><span class="s">"Rampage"</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="k">default</span><span class="p">:</span>
                    <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

    </code></pre></figure>

</div>

<h2 id="주요-기능">주요 기능</h2>

<h3 id="1-상태-관리">1. 상태 관리</h3>
<ul>
  <li>애니메이터 파라미터를 통한 상태 전환</li>
  <li>Idle 스테이트에서 랜덤한 패턴 선택</li>
</ul>

<h3 id="2-전투-로직">2. 전투 로직</h3>
<ul>
  <li>플레이어 추적 및 점프 거리 계산</li>
  <li>데미지는 애니메이션에서 콜라이더를 끄고 켜 관리</li>
</ul>

<h2 id="장점">장점</h2>
<p>애니메이터를 활용한 보스 AI 구현은 스테이트머신 구현 없이 쉽게 구현할 수 있다.</p>

<h2 id="단점">단점</h2>
<ul>
  <li>상태가 많아질수록 관리가 어려워짐</li>
  <li>스테이트를 클릭해야 코드를 확인 가능 디버깅어 어렵다</li>
  <li>애니메이션 이벤트와 스테이트 스크립트가 나뉘어 관리가 어렵다</li>
</ul>


                    </div>
                </div>
            </article>
        </div>
    </div>
</main>

    <aside class="footer-widgets">

    

    <div id="footer-columns" class="footer-columns">
        <div class="inner">
            <div class="grid">

                
                <div class="one-third">
                    <section class="widget widget-text">
                        <h2 class="widget-title">About 변석진</h2>
                        <p>유니티 클라이언트 지망하는 변석진입니다.</p>
                    </section><!-- .widget-text -->
                </div><!-- .one-third -->
                

                <div class="one-third">
                    <section class="widget widget-recent-posts">
                        <h2 class="widget-title">Latest Posts</h2>
                        <ul class="recent-posts">
                        
                            <li>
                                
                                <div class="post-title"><a href="/unity/2024/11/28/23-22-%ED%8F%89%EB%A9%B4%EC%97%90%EC%84%9C%EC%9D%98_%ED%8A%80%EC%96%B4%EC%98%A4%EB%A6%84/">버그-평면에서의 튀어오름</a></div>
                                <div class="post-date">November 28, 2024</div>
                            </li>
                        
                            <li>
                                
                                <div class="post-title"><a href="/blog/2024/11/28/17-20-%EB%AF%B8%EC%A0%81%EB%B6%84_%EA%B8%B0%EC%B4%88/">미분 정리</a></div>
                                <div class="post-date">November 28, 2024</div>
                            </li>
                        
                            <li>
                                
                                <div class="post-title"><a href="/blog/2024/11/28/16-57-%EB%A7%88%ED%81%AC%EC%97%85_%EC%A0%95%EB%A6%AC/">마크업 정리</a></div>
                                <div class="post-date">November 28, 2024</div>
                            </li>
                        
                        </ul><!-- .recent-posts -->
                    </section><!-- .widget-recent-posts -->
                </div><!-- .one-third -->

                <!-- Create a sorted array of tags -->
                <div class="one-third">
                    
                    
                    <section class="widget widget-tags">
                        <h2 class="widget-title">Tags</h2>
                        <div class="tagcloud">
                            
                            <a href="/tags/#Animation">Animation</a>
                            
                            <a href="/tags/#Animator">Animator</a>
                            
                            <a href="/tags/#Bug">Bug</a>
                            
                            <a href="/tags/#CodingTest">CodingTest</a>
                            
                            <a href="/tags/#Physics">Physics</a>
                            
                            <a href="/tags/#Programmers">Programmers</a>
                            
                            <a href="/tags/#SRP">SRP</a>
                            
                            <a href="/tags/#Unity">Unity</a>
                            
                            <a href="/tags/#algorithm">algorithm</a>
                            
                            <a href="/tags/#animator">animator</a>
                            
                        </div><!-- .tagcloud -->
                    </section><!-- .widget -->
                </div><!-- .one-third -->

            </div><!-- .grid -->
        </div><!-- .inner -->
    </div><!-- .footer-columns -->

</aside><!-- .footer-widgets -->

    <footer class="site-footer">
    <div class="inner">
        <div class="social-links">
            
            
            
            
            <a href="https://github.com/bsj2234"><i class="fa fa-github" aria-hidden="true"></i><span class="screen-reader-text">GitHub</span></a>
            
            
            <a href="https://www.youtube.com/@siko102" ><i class="fa fa-youtube-play" aria-hidden="true"></i><span class="screen-reader-text">Youtube</span></a>
            
            
            
            
            
            
        </div><!-- .social-links -->
        <div class="copyright">
            &copy; 2024 <a href="/">BlogBox</a> <br />BlogBox theme by <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>
        </div><!-- .copyright -->
        <a href="#page" id="top-link" class="top-link"><i class="fa fa-chevron-up" aria-hidden="true"></i><span class="screen-reader-text">Back to the top</span></a>
    </div><!-- .inner -->
</footer><!-- .site-footer -->

  </div><!-- .site -->

  <script type="text/javascript" src="/js/plugins.js"></script>
  <script type="text/javascript" src="/js/custom.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      Prism.highlightAll();
    });
  </script>

</body>

</html>
